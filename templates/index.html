{% load staticfiles %}
<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Male_Fashion Template">
    <meta name="keywords" content="Male_Fashion, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>社交媒体爬虫后台界面</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap"
    rel="stylesheet">

    <!-- Css Styles -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/elegant-icons.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/nice-select.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/slicknav.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/style.css' %}" type="text/css">
    <!-- Echarts Js -->
    <script src="{% static 'echarts/echarts.min.js' %}"></script>

</head>

<body>

    <!-- Header Section Begin -->
    <header class="header">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-3">
                    <div class="header__logo">
                        <h2>Scrapy monitor</h2>
                    </div>
                </div>
                <div class="col-lg-9 col-md-9">
                    <nav class="header__menu mobile-menu">
                        <ul>
                            <li class="active"><a href="{% url 'scrapy_monitor:index' %}">数据监控</a></li>
                            <li><a href=" {% url 'scrapy_monitor:day_monitor' %}">当日爬虫监控</a></li>
                            <li><a href="{% url 'scrapy_monitor:timed_monitor' %}">实时爬虫监控</a></li>
                            <li><a href={% url 'scrapy_monitor:weibo_index' %}>创建爬虫</a>
                                <ul class="dropdown">
                                    <li><a href={% url 'scrapy_monitor:weibo_index' %}>新浪微博爬虫</a></li>
                                    <li><a href={% url 'scrapy_monitor:xinlang_index' %}>新浪新闻爬虫</a></li>
                                </ul>
                            </li>
                            <li><a href="{% url 'scrapy_monitor:spider_manage' %}">爬虫任务表</a></li>
                            <li><a href='/admin/'>数据后台</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
            <div class="canvas__open"><i class="fa fa-bars"></i></div>
        </div>
    </header>
    <!-- Header Section End -->

    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-option">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6 col-sm-6">
                    <div class="counter__item">
                        <div class="counter__item__number">
                            <h2 class="cn_num">{{source_data.sinaWeibo_count|add:source_data.sinaNews_count}}</h2>
                        </div>
                        <span>Total<br />Num</span>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 col-sm-6">
                    <div class="counter__item">
                        <div class="counter__item__number">
                            <h2 class="cn_num">{{source_data.sinaWeibo_count}}</h2>
                        </div>
                        <span>Sina Weibo <br />Num</span>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 col-sm-6">
                    <div class="counter__item">
                        <div class="counter__item__number">
                            <h2 class="cn_num">{{source_data.sinaNews_count}}</h2>
                        </div>
                        <span>Sina News <br />Num</span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4 col-md-6 col-sm-6">
                    <div class="counter__item">
                        <div class="counter__item__number">
                            <h2 class="cn_num">{{diaster_data.Earthquake_count}}</h2>
                        </div>
                        <span>Earthquake <br />Num</span>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 col-sm-6">
                    <div class="counter__item">
                        <div class="counter__item__number">
                            <h2 class="cn_num">{{diaster_data.Typhoon_count}}</h2>
                        </div>
                        <span>Typhoon <br />Num</span>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 col-sm-6">
                    <div class="counter__item">
                        <div class="counter__item__number">
                            <h2 class="cn_num">{{diaster_data.Rain_count}}</h2>
                        </div>
                        <span>Rain <br />Num</span>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->


    <!-- Counter Section Begin -->
    <section class="counter ">
        <div class="container">
            <div class="row">
             <div id="source_pie" style="width: 600px;height:400px;" class="col-lg-6 col-md-6 col-sm-6"></div>
             <div id="diaster_pie" style="width: 600px;height:400px;" class="col-lg-6 col-md-6 col-sm-6"></div>

            </div>

        </div>

    </section>
    <!-- Counter Section End -->

    <!-- Footer Section Begin -->
    <footer class="footer">
        <div class="container">

            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="footer__copyright__text">
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        <p>Copyright ©
                            <script>
                                document.write(new Date().getFullYear());
                            </script>2020
                            All rights reserved | This is Social Media Scrapy Monitor <i class="fa fa-heart-o"
                            aria-hidden="true"></i>的 <a href="https://colorlib.com" target="_blank">前端</a>
                        </p>
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Search Begin -->
    <div class="search-model">
        <div class="h-100 d-flex align-items-center justify-content-center">
            <div class="search-close-switch">+</div>
            <form class="search-model-form">
                <input type="text" id="search-input" placeholder="Search here.....">
            </form>
        </div>
    </div>
    <!-- Search End -->

    <!-- Js Plugins -->
    <script src="{% static 'echarts/echarts.min.js' %}"></script>
    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/jquery.nice-select.min.js' %}"></script>
    <script src="{% static 'js/jquery.nicescroll.min.js' %}"></script>
    <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
    <script src="{% static 'js/jquery.countdown.min.js' %}"></script>
    <script src="{% static 'js/jquery.slicknav.js' %}"></script>
    <script src="{% static 'js/mixitup.min.js' %}"></script>
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <!-- 微博来源饼状图 -->
    <script type="text/javascript">
        // 基于准备好的dom，灾害帖子分布比例
        var myChart = echarts.init(document.getElementById('source_pie'));
        var data1 = {{ source_data|safe }}
        var list = new Array()
        var list_name=new Array()
        for (let key in data1){
            let dic = {'value':data1[key],'name':key}
            list.push(dic)
            list_name.push(key)
        }

        // 指定图表的配置项和数据
        option = {
            title: {
                text: '数据来源分布',
                subtext: 'source：social_scrapy',
                left: 'center'
            },
            tooltip: {
                trigger: 'item',
                formatter: '{a} <br/>{b} : {c} ({d}%)'
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                data:list_name
            },
            series: [
                {
                    name: '数据量',
                    type: 'pie',
                    radius: '55%',
                    center: ['50%', '60%'],
                    data:list,
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    </script>
    <!-- 灾害分布饼状图 -->
    <script type="text/javascript">
        // 基于准备好的dom，灾害帖子分布比例
        var myChart = echarts.init(document.getElementById('diaster_pie'));
        var data1 = {{ diaster_data|safe }}
        var list = new Array()
        var list_name=new Array()
        for (let key in data1){
            let dic = {'value':data1[key],'name':key}
            list.push(dic)
            list_name.push(key)
        }

        // 指定图表的配置项和数据
        option = {
            title: {
                text: '灾害帖子数量占比',
                subtext: 'source：social_analyse',
                left: 'center'
            },
            tooltip: {
                trigger: 'item',
                formatter: '{a} <br/>{b} : {c} ({d}%)'
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                data:list_name
            },
            series: [
                {
                    name: '数据量',
                    type: 'pie',
                    radius: '55%',
                    center: ['50%', '60%'],
                    data:list,
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    </script>
</body>

</html>
